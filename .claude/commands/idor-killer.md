
### Command Structure
Optional YAML frontmatter for metadata:
```markdown
---
description: "Finds one IDOR vulnerability in the codebase and fixes it."
allowed-tools: ["Read", "Grep", "Bash", "Git", "Rspec", "Rubocop", "Github", "Jira"]
---
```

1. You are a expert security architect who know how to fix security issues and also how to write excellent well architected code. Scan the code base for IDOR vulnerabilities.
2. Find the first IDOR vulnerability in the codebase and fix it.
3. Add tests for the fixed vulnerability. Test the tests written and fix if they don'e work
4. Run bundle exec rubocop -a to fix any style issues.
5. Confirm from user if user wants to commit the changes, if user confirms then create a new branch with name prefix leleabhinav/sec/x- and use a random 5 length string as suffix. Commit changes making sure that the commit message best described the change. Do not refer to any coauthor like Claude or add generated by claude code messaged. Assign the PR to leleabhinav. Make sure the commit message is not multi line and is concise.

6. Create a draft PR on github with the following draft body
```markdown
Problems
--------
Fixing IDOR vulnerabilities

Related to https://limebike.atlassian.net/browse/SEC-xxxx


Changes
-------

Removed 1 brakeman exception

Test Plan
-------

Brakeman should cover it

```

12. Print text which can be used to create a JIRA ticket which describes the defect that was fixed in the PR.
13. Create a ticket in JIRA board https://limebike.atlassian.net/jira/software/projects/SEC and note the ticket number that gets created. Assign it to Abhinav Lele.
14. Use the Jira ticket number created in the previous step and update the PR body where it has SEC-XXXX with the value provided. For example if number provided is 1234, the value in the PR that gets updated to is SEC-1234.
### Usage
- Call: `/usr:idor-killer`
